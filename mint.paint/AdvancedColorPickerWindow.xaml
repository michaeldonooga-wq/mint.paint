<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:av="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="av" x:Class="mint.paint.AdvancedColorPickerWindow"
        Title="Расширенная палитра"
        Width="400" Height="500"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="ToolWindow"
        Topmost="True" Background="{DynamicResource WindowBackground}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TabControl Grid.Row="0">
            <TabItem Header="Цветовой круг">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" HorizontalAlignment="Center">
                        <Image x:Name="ColorWheelImage" Width="250" Height="250" 
                              MouseDown="ColorWheel_MouseDown" MouseMove="ColorWheel_MouseMove" Cursor="Cross"/>
                        <Canvas Width="250" Height="250">
                            <Ellipse x:Name="ColorCursor" Width="10" Height="10" 
                                    Stroke="Black" StrokeThickness="2" Fill="Transparent" IsHitTestVisible="False"/>
                        </Canvas>
                    </Grid>

                    <StackPanel Grid.Row="1" Margin="0,10">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,10">
                            <Border x:Name="PrimaryColorBorder" Width="60" Height="40" BorderBrush="Black" BorderThickness="3" Cursor="Hand" MouseDown="PrimaryColor_MouseDown">
                                <Border.Background>
                                    <SolidColorBrush x:Name="CurrentColorBrush" Color="Blue"/>
                                </Border.Background>
                            </Border>
                            <Border x:Name="SecondaryColorBorder" Width="60" Height="40" BorderBrush="Gray" BorderThickness="1" Margin="5,0,0,0" Cursor="Hand" MouseDown="SecondaryColor_MouseDown">
                                <Border.Background>
                                    <SolidColorBrush x:Name="PreviousColorBrush" Color="Blue"/>
                                </Border.Background>
                            </Border>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                            <TextBlock Text="HEX:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                            <TextBox x:Name="HexTextBox" Width="100" Text="#0000FF" 
                                    FontFamily="Consolas" TextChanged="HexTextBox_TextChanged"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <TextBlock Text="A:" Width="20"/>
                            <Slider x:Name="AlphaSlider" Width="200" Minimum="0" Maximum="255" Value="255" ValueChanged="Alpha_Changed"/>
                            <TextBlock x:Name="AlphaText" Text="255" Width="30" Margin="5,0"/>
                        </StackPanel>

                        <Button x:Name="ToggleRGBButton" Content="Показать RGB" Click="ToggleRGB_Click" 
                               HorizontalAlignment="Center" Margin="0,5"/>

                        <StackPanel x:Name="RGBPanel" Visibility="Collapsed">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="R:" Width="20"/>
                                <Slider x:Name="RedSlider" Width="200" Minimum="0" Maximum="255" ValueChanged="RGB_Changed"/>
                                <TextBlock x:Name="RedText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="G:" Width="20"/>
                                <Slider x:Name="GreenSlider" Width="200" Minimum="0" Maximum="255" ValueChanged="RGB_Changed"/>
                                <TextBlock x:Name="GreenText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="B:" Width="20"/>
                                <Slider x:Name="BlueSlider" Width="200" Minimum="0" Maximum="255" ValueChanged="RGB_Changed"/>
                                <TextBlock x:Name="BlueText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                        </StackPanel>

                        <Button x:Name="ToggleHSVButton" Content="Показать HSV" Click="ToggleHSV_Click" 
                               HorizontalAlignment="Center" Margin="0,5"/>

                        <StackPanel x:Name="HSVPanel" Visibility="Collapsed">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="H:" Width="20"/>
                                <Slider x:Name="HueSlider" Width="200" Minimum="0" Maximum="360" ValueChanged="HSV_Changed"/>
                                <TextBlock x:Name="HueText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="S:" Width="20"/>
                                <Slider x:Name="SatSlider" Width="200" Minimum="0" Maximum="100" ValueChanged="HSV_Changed"/>
                                <TextBlock x:Name="SatText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <TextBlock Text="V:" Width="20"/>
                                <Slider x:Name="ValSlider" Width="200" Minimum="0" Maximum="100" ValueChanged="HSV_Changed"/>
                                <TextBlock x:Name="ValText" Text="0" Width="30" Margin="5,0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Цветовые схемы">
                <StackPanel Margin="5">
                    <ComboBox x:Name="SchemeTypeComboBox" SelectionChanged="SchemeTypeComboBox_SelectionChanged"
                             Margin="0,5">
                        <ComboBoxItem Content="Монохромная"/>
                        <ComboBoxItem Content="Аналоговая"/>
                        <ComboBoxItem Content="Комплементарная"/>
                        <ComboBoxItem Content="Триадная"/>
                        <ComboBoxItem Content="Тетрадная"/>
                    </ComboBox>

                    <ItemsControl x:Name="SchemeColorsControl" Margin="0,10">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Width="30" Height="30" Margin="2" 
                                       BorderBrush="Black" BorderThickness="1"
                                       MouseDown="ColorItem_MouseDown">
                                    <Border.Background>
                                        <SolidColorBrush Color="{Binding Color}"/>
                                    </Border.Background>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </TabItem>

            <TabItem Header="История">
                <ItemsControl x:Name="RecentColorsControl" Margin="5">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Width="25" Height="25" Margin="1" 
                                   BorderBrush="Gray" BorderThickness="1"
                                   MouseDown="ColorItem_MouseDown">
                                <Border.Background>
                                    <SolidColorBrush Color="{Binding Color}"/>
                                </Border.Background>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </TabItem>

            <TabItem Header="Палитры">
                <StackPanel Margin="5">
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <ComboBox x:Name="PaletteComboBox" SelectionChanged="PaletteComboBox_SelectionChanged" Width="240"/>
                        <Button Content="+" Click="CreatePaletteButton_Click" Width="30" Margin="5,0,0,0" ToolTip="Создать палитру"/>
                        <Button Content="Добавить цвет" Click="AddColorToPaletteButton_Click" Width="90" Margin="5,0,0,0" ToolTip="Добавить текущий цвет"/>
                    </StackPanel>

                    <ItemsControl x:Name="PaletteColorsControl" Margin="0,10">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Width="25" Height="25" Margin="1" 
                                       BorderBrush="Gray" BorderThickness="1"
                                       MouseDown="ColorItem_MouseDown">
                                    <Border.Background>
                                        <SolidColorBrush Color="{Binding Color}"/>
                                    </Border.Background>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </TabItem>
        </TabControl>


    </Grid>
</Window>
