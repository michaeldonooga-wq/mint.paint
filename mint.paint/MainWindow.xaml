<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:skia="clr-namespace:SkiaSharp.Views.WPF;assembly=SkiaSharp.Views.WPF"
        xmlns:local="clr-namespace:mint.paint"
        xmlns:av="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="av" x:Class="mint.paint.MainWindow"
        Title="mint.paint ðŸŽ¨" 
        Width="1200" Height="800"
        Background="{DynamicResource WindowBackground}" WindowState="Maximized">

    <Window.Resources>
        <Style TargetType="ContextMenu">
            <Setter Property="Background" Value="{DynamicResource WindowBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="Gray"/>
        </Style>
        <Style TargetType="MenuItem">
            <Setter Property="Background" Value="{DynamicResource WindowBackground}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource WindowBackground}"/>
        </Style>
        <Style TargetType="Separator">
            <Setter Property="Background" Value="Gray"/>
            <Setter Property="BorderBrush" Value="{DynamicResource WindowBackground}"/>
        </Style>
    </Window.Resources>

    <Grid RenderOptions.BitmapScalingMode="HighQuality" TextOptions.TextFormattingMode="Display" TextOptions.TextRenderingMode="ClearType">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Ð’ÐµÑ€Ñ…Ð½ÐµÐµ Ð¼ÐµÐ½ÑŽ -->
        <Menu Grid.Row="0" Background="{DynamicResource ControlBackground}" Foreground="{DynamicResource TextBrush}" Padding="2">
            <MenuItem x:Name="FileMenu" Header="Ð¤Ð°Ð¹Ð»">
                <MenuItem x:Name="NewMenuItem" Header="ÐÐ¾Ð²Ñ‹Ð¹" Click="NewMenuItem_Click" InputGestureText="Ctrl+N"/>
                <MenuItem x:Name="OpenMenuItem" Header="ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ..." Click="OpenMenuItem_Click" InputGestureText="Ctrl+O"/>
                <MenuItem x:Name="SaveMenuItem" Header="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ" Click="SaveMenuItem_Click" InputGestureText="Ctrl+S"/>
                <Separator/>
                <MenuItem x:Name="ResizeCanvasMenuItem" Header="Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ñ…Ð¾Ð»ÑÑ‚Ð°..." Click="ResizeCanvasMenuItem_Click" InputGestureText="Ctrl+R"/>
            </MenuItem>
            <MenuItem x:Name="EditMenu" Header="ÐŸÑ€Ð°Ð²ÐºÐ°">
                <MenuItem x:Name="UndoMenuItem" Header="ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ" Click="UndoMenuItem_Click" InputGestureText="Ctrl+Z"/>
                <MenuItem x:Name="RedoMenuItem" Header="ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ" Click="RedoMenuItem_Click" InputGestureText="Ctrl+Y"/>
                <Separator/>
                <MenuItem x:Name="CutMenuItem" Header="Ð’Ñ‹Ñ€ÐµÐ·Ð°Ñ‚ÑŒ" Click="CutMenuItem_Click" InputGestureText="Ctrl+X"/>
                <MenuItem x:Name="CopyMenuItem" Header="ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ" Click="CopyMenuItem_Click" InputGestureText="Ctrl+C"/>
                <MenuItem x:Name="PasteMenuItem" Header="Ð’ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ" Click="PasteMenuItem_Click" InputGestureText="Ctrl+V"/>
                <MenuItem x:Name="DeleteMenuItem" Header="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ" Click="DeleteMenuItem_Click" InputGestureText="Del"/>
                <MenuItem x:Name="ClearSelectionMenuItem" Header="Ð¡Ð½ÑÑ‚ÑŒ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ" Click="ClearSelectionMenuItem_Click" InputGestureText="Ctrl+D"/>
            </MenuItem>
            <MenuItem x:Name="ViewMenu" Header="Ð’Ð¸Ð´">
                <MenuItem x:Name="ToggleToolsPanelMenuItem" 
                             Header="Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹" 
                             Click="ToggleToolsPanelMenuItem_Click"/>
                <Separator/>
                <MenuItem x:Name="ToggleRulersMenuItem" Header="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð»Ð¸Ð½ÐµÐ¹ÐºÐ¸" 
                             Click="ToggleRulersMenuItem_Click" IsCheckable="True" IsChecked="True"/>
                <MenuItem x:Name="NavigatorMenuItem" Header="ÐÐ°Ð²Ð¸Ð³Ð°Ñ‚Ð¾Ñ€" Click="NavigatorMenuItem_Click" InputGestureText="F8"/>
                <MenuItem x:Name="ToggleGridMenuItem" Header="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐµÑ‚ÐºÑƒ" 
                             Click="ToggleGridMenuItem_Click" IsCheckable="True"/>
                <MenuItem x:Name="ToggleSnapToGridMenuItem" Header="ÐŸÑ€Ð¸Ð²ÑÐ·ÐºÐ° Ðº ÑÐµÑ‚ÐºÐµ" 
                             Click="ToggleSnapToGridMenuItem_Click" IsCheckable="True"/>
                <Separator/>
                <MenuItem x:Name="ShowLayersWindowMenuItem" Header="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐ»Ð¾Ð¸" 
                             Click="ShowLayersWindowMenuItem_Click" InputGestureText="F7"/>
            </MenuItem>
            <MenuItem x:Name="ColorMenu" Header="Ð¦Ð²ÐµÑ‚">
                <MenuItem x:Name="ColorPaletteMenuItem" Header="ÐŸÐ°Ð»Ð¸Ñ‚Ñ€Ð° Ñ†Ð²ÐµÑ‚Ð¾Ð²..." Click="AdvancedColorPickerButton_Click" InputGestureText="Ctrl+Shift+C"/>
                <MenuItem x:Name="SwapColorsMenuItem" Header="ÐŸÐ¾Ð¼ÐµÐ½ÑÑ‚ÑŒ Ñ†Ð²ÐµÑ‚Ð° Ð¼ÐµÑÑ‚Ð°Ð¼Ð¸" 
                             Click="SwapColorsMenuItem_Click" InputGestureText="X"/>
            </MenuItem>
            <MenuItem x:Name="LayersMenu" Header="Ð¡Ð»Ð¾Ð¸">
                <MenuItem x:Name="NewLayerMenu" Header="ÐÐ¾Ð²Ñ‹Ð¹ ÑÐ»Ð¾Ð¹" Click="NewLayerMenuItem_Click" InputGestureText="Ctrl+Shift+N"/>
                <MenuItem x:Name="DeleteLayerMenu" Header="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ»Ð¾Ð¹" Click="DeleteLayerMenuItem_Click" InputGestureText="Ctrl+Shift+D"/>
                <MenuItem x:Name="MergeVisibleMenu" Header="ÐžÐ±ÑŠÐµÐ´Ð¸Ð½Ð¸Ñ‚ÑŒ Ð²Ð¸Ð´Ð¸Ð¼Ñ‹Ðµ" Click="MergeLayersMenuItem_Click" InputGestureText="Ctrl+Shift+M"/>
                <Separator/>
                <MenuItem x:Name="ShowLayersPanelMenu" Header="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð°Ð½ÐµÐ»ÑŒ ÑÐ»Ð¾ÐµÐ²" Click="ShowLayersWindowMenuItem_Click" InputGestureText="F7"/>
            </MenuItem>
            <MenuItem x:Name="BrushMenu" Header="ÐšÐ¸ÑÑ‚ÑŒ">
                <MenuItem x:Name="BrushPresetsMenuItem" Header="ÐŸÑ€ÐµÑÐµÑ‚Ñ‹ ÐºÐ¸ÑÑ‚ÐµÐ¹" Click="BrushPresetsMenuItem_Click"/>
                <MenuItem x:Name="IncreaseBrushMenu" Header="Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ ÐºÐ¸ÑÑ‚ÑŒ" Click="IncreaseBrushSizeMenuItem_Click" InputGestureText="+]"/>
                <MenuItem x:Name="DecreaseBrushMenu" Header="Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ñ‚ÑŒ ÐºÐ¸ÑÑ‚ÑŒ" Click="DecreaseBrushSizeMenuItem_Click" InputGestureText="[-"/>
                <MenuItem x:Name="ResetBrushMenu" Header="Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ ÐºÐ¸ÑÑ‚ÑŒ" Click="ResetBrushMenuItem_Click" InputGestureText="Ctrl+R"/>
            </MenuItem>
            <MenuItem x:Name="ShapesMenu" Header="Ð¤Ð¸Ð³ÑƒÑ€Ñ‹">
                <MenuItem x:Name="LineMenu" Header="Ð›Ð¸Ð½Ð¸Ñ" Click="LineMenuItem_Click" InputGestureText="L"/>
                <MenuItem x:Name="RectangleMenu" Header="ÐŸÑ€ÑÐ¼Ð¾ÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸Ðº" Click="RectangleMenuItem_Click" InputGestureText="R"/>
                <MenuItem x:Name="CircleMenu" Header="ÐšÑ€ÑƒÐ³" Click="CircleMenuItem_Click" InputGestureText="C"/>
                <Separator/>
                <MenuItem x:Name="GradientMenu" Header="Ð“Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚" Click="GradientMenuItem_Click" InputGestureText="G"/>
            </MenuItem>
            <MenuItem x:Name="SettingsMenu" Header="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸">
                <MenuItem x:Name="SettingsMenuItem" Header="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸..." Click="SettingsMenuItem_Click"/>
                <Separator/>
                <MenuItem x:Name="AboutMenuItem" Header="Ðž Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ðµ..." Click="AboutMenuItem_Click"/>
            </MenuItem>
        </Menu>

        <!-- Ð¢ÑƒÐ»Ð±Ð°Ñ€ -->
        <ToolBar Grid.Row="1" Foreground="{DynamicResource TextBrush}" Height="32" Padding="5,2" Background="{x:Null}">
            <Button x:Name="UndoButton" Content="ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ" Click="UndoMenuItem_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}"/>
            <Button x:Name="RedoButton" Content="ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ" Click="RedoMenuItem_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}"/>
            <Separator/>
            <Button x:Name="CutButton" Content="Ð’Ñ‹Ñ€ÐµÐ·Ð°Ñ‚ÑŒ" Click="CutMenuItem_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}"/>
            <Button x:Name="CopyButton" Content="ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ" Click="CopyMenuItem_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}"/>
            <Button x:Name="PasteButton" Content="Ð’ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ" Click="PasteMenuItem_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}"/>
            <Button x:Name="ApplySelectionButton" Content="âœ“ ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ" Click="ApplySelectionButton_Click" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}" Visibility="Collapsed"/>
            <Separator/>
            <StackPanel x:Name="ShapesPanel" Orientation="Horizontal" Visibility="Collapsed">
                <TextBlock x:Name="ShapeLabel" Text="Ð¤Ð¸Ð³ÑƒÑ€Ð°:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <ComboBox x:Name="ShapesComboBox" Width="120" SelectionChanged="ShapesComboBox_SelectionChanged" FocusVisualStyle="{x:Null}">
                    <ComboBoxItem x:Name="LineComboItem" Content="Ð›Ð¸Ð½Ð¸Ñ" Tag="Line"/>
                    <ComboBoxItem x:Name="RectangleComboItem" Content="ÐŸÑ€ÑÐ¼Ð¾ÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸Ðº" Tag="Rectangle"/>
                    <ComboBoxItem x:Name="CircleComboItem" Content="ÐšÑ€ÑƒÐ³" Tag="Circle"/>
                </ComboBox>
                <Separator/>
            </StackPanel>
            <StackPanel x:Name="GradientPanel" Orientation="Horizontal" Visibility="Collapsed">
                <TextBlock x:Name="StyleLabel" Text="Ð¡Ñ‚Ð¸Ð»ÑŒ:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <ComboBox x:Name="GradientStyleComboBox" Width="120" FocusVisualStyle="{x:Null}">
                    <ComboBoxItem x:Name="LinearComboItem" Content="ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹" Tag="Linear" IsSelected="True"/>
                    <ComboBoxItem x:Name="RadialComboItem" Content="ÐšÑ€ÑƒÐ³Ð¾Ð²Ð¾Ð¹" Tag="Radial"/>
                    <ComboBoxItem x:Name="ReflectedComboItem" Content="ÐžÑ‚Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ‹Ð¹" Tag="Reflected"/>
                </ComboBox>
                <Separator/>
                <Button x:Name="AddStopsButton" Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ñ‚ÐµÐ»Ð¸" Padding="8,2" Margin="2,0" FocusVisualStyle="{x:Null}" Click="GradientStopsButton_Click"/>
                <Separator/>
            </StackPanel>
            <StackPanel x:Name="TextPanel" Orientation="Horizontal" Visibility="Collapsed">
                <TextBlock x:Name="FontLabel" Text="Ð¨Ñ€Ð¸Ñ„Ñ‚:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <ComboBox x:Name="TextFontComboBox" Width="120" FocusVisualStyle="{x:Null}"/>
                <TextBlock x:Name="TextSizeLabel" Text="Ð Ð°Ð·Ð¼ÐµÑ€:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <ComboBox x:Name="TextSizeComboBox" Width="60" IsEditable="True" FocusVisualStyle="{x:Null}"/>
                <ToggleButton x:Name="TextBoldButton" Content="B" Width="30" Margin="2,0" FontWeight="Bold" FocusVisualStyle="{x:Null}"/>
                <ToggleButton x:Name="TextItalicButton" Content="I" Width="30" Margin="2,0" FontStyle="Italic" FocusVisualStyle="{x:Null}"/>
                <ToggleButton x:Name="TextUnderlineButton" Width="30" Margin="2,0" FocusVisualStyle="{x:Null}">
                    <TextBlock Text="U" TextDecorations="Underline"/>
                </ToggleButton>
                <ToggleButton x:Name="TextStrikethroughButton" Width="30" Margin="2,0" FocusVisualStyle="{x:Null}">
                    <TextBlock Text="S" TextDecorations="Strikethrough"/>
                </ToggleButton>
                <Separator/>
                <TextBlock x:Name="AlignmentLabel" Text="Ð’Ñ‹Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð½Ð¸Ðµ:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <ComboBox x:Name="TextAlignmentCombo" Width="80" FocusVisualStyle="{x:Null}"/>
                <Separator/>
                <TextBlock x:Name="TextOpacityToolbarLabel" Text="ÐŸÑ€Ð¾Ð·Ñ€Ð°Ñ‡Ð½Ð¾ÑÑ‚ÑŒ:" VerticalAlignment="Center" Margin="5,0,3,0"/>
                <Slider x:Name="TextOpacitySlider" Width="80" Minimum="0" Maximum="100" Value="100" VerticalAlignment="Center" FocusVisualStyle="{x:Null}"/>
                <TextBlock x:Name="TextOpacityLabel" Width="30" VerticalAlignment="Center" Margin="3,0,5,0" Text="100%"/>
                <Separator/>
                <Border x:Name="TextColorBox" Width="24" Height="24" BorderBrush="Gray" BorderThickness="1" Margin="5,0" Cursor="Hand" MouseDown="TextColorBox_Click"/>
            </StackPanel>
            <TextBlock x:Name="SizeLabel" Text="Ð Ð°Ð·Ð¼ÐµÑ€:" VerticalAlignment="Center" Margin="5,0,3,0" Foreground="{DynamicResource TextBrush}"/>
            <Slider x:Name="BrushSizeSlider" Width="100" Minimum="1" Maximum="100" Value="30" 
                       VerticalAlignment="Center" ValueChanged="BrushSizeSlider_ValueChanged" FocusVisualStyle="{x:Null}"/>
            <TextBlock x:Name="BrushSizeText" Text="30" Width="25" VerticalAlignment="Center" Margin="3,0,5,0" Foreground="{DynamicResource TextBrush}"/>
            <Separator/>
            <TextBlock x:Name="HardnessLabel" Text="Ð–ÐµÑÑ‚ÐºÐ¾ÑÑ‚ÑŒ:" VerticalAlignment="Center" Margin="5,0,3,0" Foreground="{DynamicResource TextBrush}"/>
            <Slider x:Name="BrushHardnessSlider" Width="100" Minimum="0" Maximum="100" Value="0" 
                       VerticalAlignment="Center" ValueChanged="BrushHardnessSlider_ValueChanged" FocusVisualStyle="{x:Null}"/>
            <TextBlock x:Name="BrushHardnessText" Text="0" Width="25" VerticalAlignment="Center" Margin="3,0,5,0" Foreground="{DynamicResource TextBrush}"/>
            <StackPanel x:Name="DropsPanel" Orientation="Horizontal" Visibility="Collapsed">
                <Separator/>
                <TextBlock Text="Ð Ð°Ð·Ð¼ÐµÑ€ ÐºÐ°Ð¿ÐµÐ»ÑŒ:" VerticalAlignment="Center" Margin="5,0,3,0" Foreground="{DynamicResource TextBrush}"/>
                <Slider x:Name="DropSizeSlider" Width="80" Minimum="0.1" Maximum="1" Value="0.3" 
                           VerticalAlignment="Center" ValueChanged="DropSizeSlider_ValueChanged" FocusVisualStyle="{x:Null}"/>
                <TextBlock x:Name="DropSizeText" Text="0.3" Width="30" VerticalAlignment="Center" Margin="3,0,5,0" Foreground="{DynamicResource TextBrush}"/>
                <Separator/>
                <TextBlock Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾:" VerticalAlignment="Center" Margin="5,0,3,0" Foreground="{DynamicResource TextBrush}"/>
                <Slider x:Name="DropCountSlider" Width="80" Minimum="1" Maximum="10" Value="2" 
                           VerticalAlignment="Center" ValueChanged="DropCountSlider_ValueChanged" FocusVisualStyle="{x:Null}"/>
                <TextBlock x:Name="DropCountText" Text="2" Width="25" VerticalAlignment="Center" Margin="3,0,5,0" Foreground="{DynamicResource TextBrush}"/>
            </StackPanel>
            <Separator/>
            <Border x:Name="PrimaryColorPreview" Width="24" Height="24" Background="Blue" 
                       BorderBrush="#0078d7" BorderThickness="2" Margin="5,0,2,0" Cursor="Hand"
                       MouseDown="PrimaryColorPreview_MouseDown"/>
            <Border x:Name="SecondaryColorPreview" Width="24" Height="24" Background="White" 
                       BorderBrush="Gray" BorderThickness="1" Margin="2,0,5,0" Cursor="Hand"
                       MouseDown="SecondaryColorPreview_MouseDown"/>
        </ToolBar>

        <!-- Ð›Ð¸Ð½ÐµÐ¹ÐºÐ¸ -->
        <Grid x:Name="RulersRow" Grid.Row="2" Height="20" Background="#E0E0E0" ClipToBounds="True">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Border Grid.Column="0" Background="#D0D0D0"/>
            <Canvas Grid.Column="1" x:Name="HorizontalRuler" Background="#E0E0E0"/>
        </Grid>
        
        <!-- ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <Canvas Grid.Column="0" x:Name="VerticalRuler" Background="#E0E0E0" ClipToBounds="True"/>
            
            <Grid Grid.Column="1" Background="#c0c0c0" Cursor="Cross">
                <skia:SKElement x:Name="DrawingSurface"/>

                <Border x:Name="BrushSizeIndicator" Background="#7f34495e" CornerRadius="10"
                       HorizontalAlignment="Center" VerticalAlignment="Center" Padding="15,8" Visibility="Collapsed">
                    <TextBlock x:Name="BrushSizeIndicatorText" Text="5px" Foreground="White" FontWeight="Bold" FontSize="16"/>
                </Border>

                <Canvas>
                    <Ellipse x:Name="BrushPreview" Width="10" Height="10" Stroke="Black" StrokeThickness="1" 
                            Fill="Transparent" Visibility="Collapsed" IsHitTestVisible="False"/>
                    <Rectangle x:Name="PixelBrushPreview" Width="10" Height="10" Stroke="Black" StrokeThickness="1" 
                            Fill="Transparent" Visibility="Collapsed" IsHitTestVisible="False"/>
                    <TextBox x:Name="HiddenTextInput" Width="1" Height="1" Opacity="0" 
                             BorderThickness="0" Background="Transparent" IsHitTestVisible="False"/>
                    <Border x:Name="TextMoveButton" Width="24" Height="24" Background="#E0FFFFFF" 
                            BorderBrush="#0078d7" BorderThickness="1.5" CornerRadius="12" 
                            Visibility="Collapsed" Cursor="Hand" MouseDown="TextMoveButton_MouseDown"
                            MouseEnter="TextMoveButton_MouseEnter" MouseLeave="TextMoveButton_MouseLeave"
                            RenderTransformOrigin="0.5,0.5">
                        <Border.RenderTransform>
                            <ScaleTransform x:Name="TextMoveButtonScale" ScaleX="1" ScaleY="1"/>
                        </Border.RenderTransform>
                        <Viewbox Width="14" Height="14">
                            <Canvas Width="24" Height="24">
                                <Path Data="M12,4 L12,20 M4,12 L20,12" Stroke="#0078d7" StrokeThickness="2"/>
                                <Path Data="M12,4 L9,7 M12,4 L15,7" Stroke="#0078d7" StrokeThickness="2"/>
                                <Path Data="M12,20 L9,17 M12,20 L15,17" Stroke="#0078d7" StrokeThickness="2"/>
                                <Path Data="M4,12 L7,9 M4,12 L7,15" Stroke="#0078d7" StrokeThickness="2"/>
                                <Path Data="M20,12 L17,9 M20,12 L17,15" Stroke="#0078d7" StrokeThickness="2"/>
                            </Canvas>
                        </Viewbox>
                    </Border>
                </Canvas>
            </Grid>
        </Grid>
        
        <!-- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð±Ð°Ñ€ -->
        <StatusBar Grid.Row="4" Background="{DynamicResource ControlBackground}" Foreground="{DynamicResource TextBrush}">
            <StatusBar.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="ÐÐ¾Ð²Ñ‹Ð¹ ÑÐ»Ð¾Ð¹" Click="NewLayerMenuItem_Click"/>
                    <MenuItem Header="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ»Ð¾Ð¹" Click="DeleteLayerMenuItem_Click"/>
                    <Separator/>
                    <MenuItem Header="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð°Ð½ÐµÐ»ÑŒ ÑÐ»Ð¾ÐµÐ²" Click="ShowLayersWindowMenuItem_Click"/>
                    <Separator/>
                    <MenuItem Header="ÐŸÐ°Ð»Ð¸Ñ‚Ñ€Ð° Ñ†Ð²ÐµÑ‚Ð¾Ð²" Click="AdvancedColorPickerButton_Click"/>
                </ContextMenu>
            </StatusBar.ContextMenu>
            <StatusBarItem>
                <TextBlock x:Name="CoordinatesText" Text="X: 0, Y: 0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="ToolText" Text="Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚: ÐšÐ¸ÑÑ‚ÑŒ"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="BrushInfoText" Text="ÐšÐ¸ÑÑ‚ÑŒ: 5px, 100% Ð¶ÐµÑÑ‚ÐºÐ¾ÑÑ‚ÑŒ"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="LayerInfoText" Text="Ð¡Ð»Ð¾Ð¹: Background"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="GridInfoText" Text="Ð¡ÐµÑ‚ÐºÐ°: Ð²Ñ‹ÐºÐ»"/>
            </StatusBarItem>
        </StatusBar>

    </Grid>
</Window>
